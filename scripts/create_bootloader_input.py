#!/usr/bin/env python3
"""
Creates a full bootloader_input.json with RunProgramTask for GPS Statement Verifier.
"""
import json
import os
import sys

def create_bootloader_input(program_path, program_input_path, output_path):
    # Read program and program_input
    with open(program_path, 'r') as f:
        program = json.load(f)
    
    with open(program_input_path, 'r') as f:
        program_input = json.load(f)
    
    # Create full bootloader input
    bootloader_input = {
        "bootloader_config": {
            "simple_bootloader_program_hash": 2837065596727015720211588542358388273918703458440061085859263118820688767610,
            "supported_cairo_verifier_program_hashes": [
                3289284427977600800525737450803413687876286181930608272715714269183736285902,
                2763470879268054979941676298404372937394406713515920206056441839506998782884,
                2118292751991598993717961463480582403044924237788721297236161990534698787431,
                399637513445410357992992565170520466327433490557505082591738065473403047590,
                2742234828617213176563808433710295198854143962393423519937508507116471448046,
                119743703026665011350321130249234023681497789476249365043487314483294248120,
                24298835934944282585640554150394555924724440949626039322827645795448092325,
                1426201614682794271679500238991563618209952744251524980478135834886445655874,
                713677652533500739682702994309355225461438127607647935804228774430225314272,
                972270624639809357958247584981661387798262636387499152125566301375375590624,
                2469779681367471685169203553062914500944878019879962791890149555807317904730,
                380591720587411020984042908712212248109582471087330413920688176418727041940,
                978226752434872239973375213140194477475336855478510537459455407093090270977,
                120940520380282924164098687812543857856774211702206866669484604823382810655,
                478384793813684213006364782749249509557560561564410296325137450793458468595,
                237262601017521532686046646052838972554768810223690402640601317385300479931,
                1804284044820698340424770917169928865494180535029679406827810889709267422258,
                2339017561267275028885272466958715107906456675214186210181660582480667858404,
                1145880873488035788100375326995202592056999110333467563520005396207123408708,
                278947714377504502213414060840232790320749648487182599275495559271131767918,
                3231634479553503151789618167560019671126022298799480842469604814742269843153,
                3194856065531354630866975826900890210853240378127462753827207538672710808952,
                1510331725288007409355098932382430076288590319029694874141531708429871389323,
                2014000772032643234385595326299115477625037267243373301083876084234598174456,
                3433891682414491397883640076469770290917142654971912691222049052706662564660,
                3448942089703699761027519022696171265530691172344354856164506582482388086970,
                3086444456874939686742829194497937732413556995402033916513014444408040949175
            ],
            "applicative_bootloader_program_hash": 0
        },
        "packed_outputs": [{}],
        "tasks": [
            {
                "type": "RunProgramTask",
                "program": program,
                "program_input": program_input,
                "use_poseidon": False
            }
        ],
        "fact_topologies_path": os.path.abspath(os.path.join(os.path.dirname(output_path), "fact_topologies.json")),
        "single_page": False
    }
    
    # Write to output
    with open(output_path, 'w') as f:
        json.dump(bootloader_input, f, indent=2)
    
    print(f"âœ“ Created full bootloader_input.json with RunProgramTask")

if __name__ == "__main__":
    if len(sys.argv) != 4:
        print("Usage: python3 create_bootloader_input.py <program.json> <program_input.json> <output.json>")
        sys.exit(1)
    
    create_bootloader_input(sys.argv[1], sys.argv[2], sys.argv[3])
